"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),React__default=_interopDefault(React),PropTypes=_interopDefault(require("prop-types")),history=require("history"),createContext=(require("tiny-warning"),_interopDefault(require("mini-create-react-context"))),invariant=_interopDefault(require("tiny-invariant")),pathToRegexp=_interopDefault(require("path-to-regexp")),hoistStatics=(require("react-is"),_interopDefault(require("hoist-non-react-statics")));function _extends(){return(_extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),_setPrototypeOf(t.prototype.constructor=t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};for(var n,o={},r=Object.keys(t),a=0;a<r.length;a++)n=r[a],0<=e.indexOf(n)||(o[n]=t[n]);return o}var createNamedContext=function(t){var e=createContext();return e.displayName=t,e},historyContext=createNamedContext("Router-History"),createNamedContext$1=function(t){var e=createContext();return e.displayName=t,e},context=createNamedContext$1("Router");function useBasePath(){var t,e=null==(e=React.useContext(contexts.ExtensionContext))||null==(e=e.pageInfo)?void 0:e.basePath;return e||invariant(!1),e?(t=e.split("/")[1],"/"===(e=e.replace("/"+t,"")).substr(-1)?e.substring(0,e.length-1):e):""}function Router(e){var n=null==(t=React.useContext(contexts.ExtensionContext))||null==(t=t.dashboardInfo)?void 0:t.history,t=React.useState(n.location),o=t[0],r=t[1],t=React.useState(!1),a=t[0],i=t[1],t=React.useState(null),c=t[0],u=t[1],s=useBasePath();return React.useEffect(function(){return i(!0),c&&r(c),function(){n.unlisten&&n.unlisten()}},[c,n]),React.useEffect(function(){var t;if(!e.staticContext)return t=n.listen(function(t){(a?r:u)(t)}),function(){t()}},[a,n,e.staticContext]),React.useEffect(function(){e.debug&&(console.warn("Debug mode enabled. It should be disabled before production deployment."),console.log("initial history is: ",JSON.stringify(n,null,2)),n.listen(function(t,e){console.log("<---------- History mutated ----------\x3e"),console.log("Current Browser URL: "+t.pathname+t.search+t.hash),console.log("Last history mutation: "+e,JSON.stringify(n,null,2))}))},[e.debug,n,e.children,s]),React__default.createElement(context.Provider,{value:{history:n,location:o,match:Router.computeRootMatch(o.pathname),staticContext:e.staticContext,baseExtensionPath:s}},React__default.createElement(historyContext.Provider,{children:e.children||null,value:_extends({},n,{push:function(t){n.push(s+t)},replace:function(t){n.replace(s+t)},location:_extends({},n.location,{pathname:s+n.location.pathname})})}))}Router.computeRootMatch=function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}},Router.propTypes={children:PropTypes.node,history:PropTypes.object.isRequired,staticContext:PropTypes.object,debug:PropTypes.bool};var MemoryRouter=function(r){function t(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r.call.apply(r,[this].concat(n))||this).history=history.createMemoryHistory(t.props),t}return _inheritsLoose(t,r),t.prototype.render=function(){return React__default.createElement(Router,{history:this.history,children:this.props.children})},t}(React__default.Component),Lifecycle=function(t){function e(){return t.apply(this,arguments)||this}_inheritsLoose(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(t){this.props.onUpdate&&this.props.onUpdate.call(this,this,t)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},e}(React__default.Component);function Prompt(t){var o=t.message,t=t.when,e=void 0===t||t;return React__default.createElement(context.Consumer,null,function(t){var n;return t||invariant(!1),!e||t.staticContext?null:(n=t.history.block,React__default.createElement(Lifecycle,{onMount:function(t){t.release=n(o)},onUpdate:function(t,e){e.message!==o&&(t.release(),t.release=n(o))},onUnmount:function(t){t.release()},message:o}))})}var cache={},cacheLimit=1e4,cacheCount=0;function compilePath(t){var e;return cache[t]||(e=pathToRegexp.compile(t),cacheCount<cacheLimit&&(cache[t]=e,cacheCount++),e)}function generatePath(t,e){return void 0===e&&(e={}),"/"===(t=void 0===t?"/":t)?t:compilePath(t)(e,{pretty:!0})}function Redirect(t){var a=t.computedMatch,i=t.to,t=t.push,c=void 0!==t&&t;return React__default.createElement(context.Consumer,null,function(t){var e=t.baseExtensionPath+((null==i?void 0:i.pathname)||i),n=(t||invariant(!1),t.history),t=t.staticContext,o=c?n.push:n.replace,r=history.createLocation(a?"string"==typeof i?generatePath(e,a.params):_extends({},i,{pathname:generatePath(e,a.params)}):i);return t?(o(r),null):React__default.createElement(Lifecycle,{onMount:function(){o(r)},onUpdate:function(t,e){e=history.createLocation(e.to);history.locationsAreEqual(e,_extends({},r,{key:e.key}))||o(r)},to:i})})}var cache$1={},cacheLimit$1=1e4,cacheCount$1=0;function compilePath$1(t,e){var n,o=""+e.end+e.strict+e.sensitive,o=cache$1[o]||(cache$1[o]={});return o[t]||(e={regexp:pathToRegexp(t,n=[],e),keys:n},cacheCount$1<cacheLimit$1&&(o[t]=e,cacheCount$1++),e)}function matchPath(a,t){var t=t="string"!=typeof(t=void 0===t?{}:t)&&!Array.isArray(t)?t:{path:t},e=t.path,n=t.exact,i=void 0!==n&&n,n=t.strict,c=void 0!==n&&n,n=t.sensitive,u=void 0!==n&&n;return[].concat(e).reduce(function(t,e){var n,o,r;return e||""===e?t||(r=(t=compilePath$1(e,{end:i,strict:c,sensitive:u})).regexp,t=t.keys,!(r=r.exec(a))||(n=r[0],o=r.slice(1),r=a===n,i&&!r)?null:{path:e,url:"/"===e&&""===n?"/":n,isExact:r,params:t.reduce(function(t,e,n){return t[e.name]=o[n],t},{})}):null},null)}function evalChildrenDev(t,e,n){return t(e)||null}var Route=function(t){function e(){return t.apply(this,arguments)||this}return _inheritsLoose(e,t),e.prototype.render=function(){var r=this;return React__default.createElement(context.Consumer,null,function(t){var e=t.baseExtensionPath+r.props.path,n=(t||invariant(!1),r.props.location||t.location),e=r.props.computedMatch||(e?matchPath(n.pathname,_extends({},r.props,{path:e})):t.match),t=_extends({},t,{location:n,match:e}),n=r.props,e=n.children,o=n.component,n=n.render;return Array.isArray(e)&&0===e.length&&(e=null),React__default.createElement(context.Provider,{value:t},t.match?e?"function"==typeof e?evalChildrenDev(e,t):e:o?React__default.createElement(o,t):n?n(t):null:null)})},e}(React__default.Component),_excluded=["basename","context","location"];function addLeadingSlash(t){return"/"===t.charAt(0)?t:"/"+t}function addBasename(t,e){return t?_extends({},e,{pathname:addLeadingSlash(t)+e.pathname}):e}function stripBasename(t,e){return!t||(t=addLeadingSlash(t),0!==e.pathname.indexOf(t))?e:_extends({},e,{pathname:e.pathname.substr(t.length)})}function createURL(t){return"string"==typeof t?t:history.createPath(t)}function staticHandler(t){return function(){invariant(!1)}}function noop(){}var StaticRouter=function(r){function t(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))||this).handlePush=function(t){return e.navigateTo(t,"PUSH")},e.handleReplace=function(t){return e.navigateTo(t,"REPLACE")},e.handleListen=function(){return noop},e.handleBlock=function(){return noop},e}_inheritsLoose(t,r);var e=t.prototype;return e.navigateTo=function(t,e){var n=this.props,o=n.basename,o=void 0===o?"":o,n=n.context,n=void 0===n?{}:n;n.action=e,n.location=addBasename(o,history.createLocation(t)),n.url=createURL(n.location)},e.render=function(){var t=this.props,e=t.basename,n=void 0===e?"":e,e=t.context,e=void 0===e?{}:e,o=t.location,o=void 0===o?"/":o,t=_objectWithoutPropertiesLoose(t,_excluded),o={createHref:function(t){return addLeadingSlash(n+createURL(t))},action:"POP",location:stripBasename(n,history.createLocation(o)),push:this.handlePush,replace:this.handleReplace,go:staticHandler(),goBack:staticHandler(),goForward:staticHandler(),listen:this.handleListen,block:this.handleBlock};return React__default.createElement(Router,_extends({},t,{history:o,staticContext:e}))},t}(React__default.Component),Switch=function(t){function e(){return t.apply(this,arguments)||this}return _inheritsLoose(e,t),e.prototype.render=function(){var e=this;return React__default.createElement(context.Consumer,null,function(t){var a,i,c=t.baseExtensionPath,u=(t||invariant(!1),e.props.location||t.location);return React__default.Children.forEach(e.props.children,function(t){var e,n,o,r;null==i&&React__default.isValidElement(t)&&(e=(r=t.props).path,n=r.exact,o=r.strict,r=r.sensitive,i=matchPath(u.pathname,{path:c+(e||""),exact:void 0!==n&&n,strict:void 0!==o&&o,sensitive:void 0!==r&&r}))&&(a=t)}),i?React__default.cloneElement(a,{location:u,computedMatch:i}):null})},e}(React__default.Component),_excluded$1=["wrappedComponentRef"];function withRouter(o){function t(t){var e=t.wrappedComponentRef,n=_objectWithoutPropertiesLoose(t,_excluded$1);return React__default.createElement(context.Consumer,null,function(t){return t||invariant(!1),React__default.createElement(o,_extends({},n,t,{ref:e}))})}var e="withRouter("+(o.displayName||o.name)+")";return t.displayName=e,t.WrappedComponent=o,hoistStatics(t,o)}var useContext=React__default.useContext;function useHistory(){return useContext(historyContext)}function useLocation(){return useContext(context).location}function useParams(){var t=useContext(context).match;return t?t.params:{}}function useRouteMatch(t){var e=useLocation(),n=useContext(context).match;return t?matchPath(e.pathname,t):n}exports.MemoryRouter=MemoryRouter,exports.Prompt=Prompt,exports.Redirect=Redirect,exports.Route=Route,exports.Router=Router,exports.StaticRouter=StaticRouter,exports.Switch=Switch,exports.__HistoryContext=historyContext,exports.__RouterContext=context,exports.generatePath=generatePath,exports.matchPath=matchPath,exports.useHistory=useHistory,exports.useLocation=useLocation,exports.useParams=useParams,exports.useRouteMatch=useRouteMatch,exports.withRouter=withRouter;
//# sourceMappingURL=react-router.min.js.map
